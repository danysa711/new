diff --git a/node_modules/ws/lib/websocket-server.js b/node_modules/ws/lib/websocket-server.js
index 50deb5e..2d28e9d 100644
--- a/node_modules/ws/lib/websocket-server.js
+++ b/node_modules/ws/lib/websocket-server.js
@@ -266,6 +266,14 @@ class WebSocketServer extends EventEmitter {
       const version = +req.headers['sec-websocket-version'];
       const extensions = {};
 
+      // Add protection against DoS from excessive headers
+      const headerCount = Object.keys(req.headers).length;
+      const maxHeaders = 100; // Set a reasonable limit
+      
+      if (headerCount > maxHeaders) {
+        return abortHandshake(socket, 400, 'Too many headers');
+      }
+
       if (
         req.method !== 'GET' ||
         req.headers.upgrade.toLowerCase() !== 'websocket' ||